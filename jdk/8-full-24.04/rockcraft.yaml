name: jdk

base: ubuntu@24.04
version: '8-full-24.04'
summary: OpenJDK 8 on Ubuntu 24.04
description: |
  Ubuntu 24.04-based rock with openjdk-17-jdk package installed
platforms:
  amd64:
  arm64:

environment:
  JAVA_HOME: /usr/lib/jvm/java-8-openjdk-${CRAFT_ARCH_BUILD_FOR}

run-user: _daemon_

parts:
  openjdk:
    plugin: nil
    stage-packages: ["openjdk-8-jdk"]
    override-build: |
      JAVA_HOME=usr/lib/jvm/java-8-openjdk-${CRAFT_ARCH_BUILD_FOR}
      cd ${CRAFT_PART_INSTALL}
      for tool in `ls ${CRAFT_PART_INSTALL}/${JAVA_HOME}/bin`; do
        ln -s --relative ${JAVA_HOME}/bin/${tool} usr/bin/
      done
      craftctl default
